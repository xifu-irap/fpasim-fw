# fpasim-fw
Focal Plan Assembly simulator firmware

## definition
  The **@project_root_path** value represent the root path of this project. So, the user can clone this project where he wants. 


## Project Tree Structure

The following tree directories summarize each part of the project tree structure.

* (dir.) **git**: Git repository (don't touch).
* (dir.) **constraints**: Vivado synthesis tool constraints.
	* (dir.) **constrs_1**: vivado constraint files.
		* (file) **xem7350.xdc**: FPGA I/O pin constraints.
		* (file) **IO.xdc**: clock and I/O timing constraints.
		* (file) **placement.xdc**: placement constraints (FPGA area selection by functions).
		* (file) **fmc_pinout_pandas.py (optional)**: generate a temporary FPGA I/O pin constraints (used only to help to build the IO.xdc file).
		* (file) **fmc_pinout_col_x.csv (optional)**: by fmc column, these files (used by the fmc_pinout_pandas.py) describe the relationship between the FMC (loc,name,...) and the FPGA (port name, pin location).
* (dir.) **ip**: IP source files linked to the FPGA technology or a board vendor
	* (dir.) **opal_kelly**: IP source files from Opal Kelly.
	* (dir.) **xilinx**: IP source files from Xilinx.
		* (dir.) **coregen**: IP source files generated by GUI configuration.
		* (dir.) **xpm**: wrapper source files on the Xilinx XPM macro.
* (dir.) **project**: Vivado project file (specific to a Vivado version).
* (dir.) **simu**: files for the VHDL simulation: VHDL testbench files, test variant files, waveform files, ...
	* (dir.) **lib**: VHDL and python simulation libraries for the VHDL simulation.
		* (dir.) **common**: common python and VHDL libraries for the VHDL simulation (helping functions).
		* (dir.) **csv**: VHDL library for the VHDL simulation. This library manages the reading/writing of the csv files.
		* (dir.) **opal_kelly**: VHDL library for the VHDL simulation. This library manages the reading/writing on the **Opal Kelly USB** link.
	* (dir.) **run**: python scripts used to configure the Git project and to run one or several VHDL simulation(s).
		* (file) **conf_sim.py**: Define the VHDL unitary tests and copy Opal Kelly IP sources files (on the PC) into the ip/opal_kelly project directory (essential for the project compilation).
		* (file) **launch_sim.py**: Run one or several VHDL simulation(s).
	* (dir.) **cosim**: source files for the co-simulation with the DRE-DEMUX.
* (dir.) **src/hdl**: VHDL source files.
	* (dir.) **clocking**: manage the design clocks (except the USB clock)
	* (dir.) **fpasim**: source files of the FPASim function.
	* (dir.) **io**: manage the FPGA IO interface.
	* (dir.) **reset**: manage the design reset.
	* (dir.) **spi**: manage the spi bridge.
	* (dir.) **utils**: common source files used everywhere in the design.
* (dir.) **sw/script**: JavaScript files for the FPGA board test.
	* (dir.) **fpasim**: base functions used in the JavaScript test files. These scripts are used in conjunction with the FPGA board.
	* (file) **fpasim_test_check_tmtc_link.dscript**: test the FPGA configuration(register access, RAM configuration, ...).
	* (file) **fpasim_test_make_pulse_generation.dscript**: test the make_pulse/make_pulses commands.







